# Tanya

"Победа. Такая соблазнительная вещь. Естественно, каждый хочет почувствовать вкус." - Таня фон Дегуршаф

# Установка

Это руководство написано для *Ubuntu*. Для других версий Linux адаптируйте команды, где это необходимо.

## (1) Разрешить вход в систему Root

Мы убедимся, что пользователь `root` может войти в систему.

1. Настройте пароль пользователя `root`:

```
sudo passwd
```

Смотрите [эту страницу для получения дополнительной информации](https://www.cyberciti.biz/faq/how-can-i-log-in-as-root/) о пользователе root.

## (2) Отключить трассировку процессов

Мы позаботимся о том, чтобы пользователи без права рута не могли использовать возможности `ptrace`.

1. Переключитесь на пользователя `root`:

```
su
```

2. Откройте `/etc/sysctl.d/10-ptrace.conf` с помощью *vim* или другим редактором текста:

```
vim /etc/sysctl.d/10-ptrace.conf
```

3. Измените значение `kernel.yama.ptrace_scope` на `2`.:

```
kernel.yama.ptrace_scope = 2
```

4. Перезагрузите систему:

```
reboot
```

5. Проверьте, что `ptrace_scope` установлен на `2`:

```
sysctl kernel.yama.ptrace_scope
```

Смотрите [эту страницу для получения дополнительной информации](https://www.kernel.org/doc/Documentation/security/Yama.txt) о трассировке процессов.

## (3) Установка .NET

Мы убедимся, что `Tanya` может быть скомпилирован с *.NET*.

1. Переключитесь на пользователя `root`:

```
su
```

2. Добавьте репозитории пакетов *Microsoft* (в накоторых linux включены изначально):

* Подробнее https://docs.microsoft.com/en-us/dotnet/core/install/linux.
* Обязательно тщательно следуйте инструкциям для вашей версии Linux.
* Пример скриптовой установки, выполнять по порядку:

* Открытть терминал в нужной папке.
```
wget https://dot.net/v1/dotnet-install.sh -O dotnet-install.sh
sudo chmod +x ./dotnet-install.sh
./dotnet-install.sh --version latest
```

3. Установка *.NET 6.0*:

```
apt update && apt install -y dotnet-sdk-6.0
```

## (4) Собираем Сервис

Построим `Tanya`, чтобы мы могли зарегистрировать его как сервис:

1. Переключитесь на пользователя `root`:

```
su
```

2. Откройте директорию `/root`:

```
cd ~
```

3. Установите зависимые компоненты:

```
apt install -y git
```

4. Клонируйте этот репозиторий:

```
git clone https://github.com/ascent-sys/Tanya
```

5. Откройте директорию `Tanya`:

```
cd ~/Tanya
```

6. Разрешить выполнение *сценария сборки*:

```
chmod +x service-build.sh
```

8. Запустите сценарий *сборки*:

```
./service-build.sh
```

## (5) Установите серсвис

Мы установим `Tanya` как сервис:

1. Откройте директорию `bin`:

```
cd ~/Tanya/bin
```

2. Запустите скрипт *установки*:

```
./si.sh
```

* Введите уникальное название для сервиса, например Discord и т.п.
* Как только вы выполните эти инструкции, `Tanya` будет готова к использованию!
* Чтобы отключить сервис запустите скрипт отключения:

```
./su.sh
```

* В поле ввидте название сервиса которое ввели при установке сервиса.

## (7) Рекомендации

* Перееименуйте скомпилированный файл 'Tanya' на какой-нибудь другой.
* Откройте редактором текста файл 'si.sh' измените в нём 'Tanya' на то название файла, которое задали.
* Скопируйте папку bin или файлы из неё в другую папку без упоминания слова 'Tanya'.
* Используйте эту папку для установки сервиса.
